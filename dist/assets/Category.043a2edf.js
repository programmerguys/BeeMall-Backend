import{_ as E,r as S,v as L,g as V,o as N,c as D,w as l,b as y,f as a,q as b,s as g,K as m,h as z,i as U,l as q,j as T,L as j,x as A,d as M,U as O,e as W,M as K,N as G,O as H,P as J,E as Q,R as w,S as X,T as Y}from"./index.b5a3525d.js";/* empty css             *//* empty css               *//* empty css              *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                   *//* empty css                *//* empty css                  */const Z={class:"dialog-footer"},ee={__name:"DialogAddCategory",props:{type:String,reload:Function},setup(I,{expose:_}){const i=I,v=S(null),t=L(),e=V({visible:!1,categoryLevel:1,parentId:0,ruleForm:{name:"",rank:""},rules:{name:[{required:"true",message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],rank:[{required:"true",message:"\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),d=n=>{g.get(`/categories/${n}`).then(r=>{e.ruleForm={name:r.categoryName,rank:r.categoryRank},e.parentId=r.parentId,e.categoryLevel=r.categoryLevel})},C=n=>{if(e.visible=!0,n)e.id=n,d(n);else{const{level:r=1,parent_id:p=0}=t.query;e.ruleForm={name:"",rank:""},e.parentId=p,e.categoryLevel=r}},k=()=>{e.visible=!1},x=()=>{v.value.validate(n=>{n&&(i.type=="add"?g.post("/categories",{categoryLevel:e.categoryLevel,parentId:e.parentId,categoryName:e.ruleForm.name,categoryRank:e.ruleForm.rank}).then(()=>{m.success("\u6DFB\u52A0\u6210\u529F"),e.visible=!1,i.reload&&i.reload()}):g.put("/categories",{categoryId:e.id,categoryLevel:e.categoryLevel,parentId:e.categoryLevel,categoryName:e.ruleForm.name,categoryRank:e.ruleForm.rank}).then(()=>{m.success("\u4FEE\u6539\u6210\u529F"),e.visible=!1,i.reload&&i.reload()}))})};return _({open:C,close:k}),(n,r)=>{const p=z,h=U,o=q,s=T,u=j;return N(),D(u,{title:e.type=="add"?"\u6DFB\u52A0\u5206\u7C7B":"\u4FEE\u6539\u5206\u7C7B",modelValue:e.visible,"onUpdate:modelValue":r[3]||(r[3]=c=>e.visible=c),width:"400px"},{footer:l(()=>[y("span",Z,[a(s,{onClick:r[2]||(r[2]=c=>e.visible=!1)},{default:l(()=>[b("\u53D6 \u6D88")]),_:1}),a(s,{type:"primary",onClick:x},{default:l(()=>[b("\u786E \u5B9A")]),_:1})])]),default:l(()=>[a(o,{model:e.ruleForm,rules:e.rules,ref_key:"formRef",ref:v,"label-width":"100px",class:"good-form"},{default:l(()=>[a(h,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:l(()=>[a(p,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":r[0]||(r[0]=c=>e.ruleForm.name=c)},null,8,["modelValue"])]),_:1}),a(h,{label:"\u6392\u5E8F\u503C",prop:"rank"},{default:l(()=>[a(p,{type:"number",modelValue:e.ruleForm.rank,"onUpdate:modelValue":r[1]||(r[1]=c=>e.ruleForm.rank=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}}};var te=E(ee,[["__file","/Users/picopicopico/Programmer/Project/Web_Project/vue3-admin/src/components/DialogAddCategory.vue"]]);const oe={class:"header"},ae=["onClick"],re=["onClick"],le=y("a",{style:{cursor:"pointer"}},"\u5220\u9664",-1),ne={__name:"Category",setup(I){const _=S(null),i=A(),v=L(),t=V({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",level:1,parent_id:0});M(()=>{d()}),O(()=>{console.log(t.pageSize)});const e=i.afterEach(o=>{["category","level2","level3"].includes(o.name)&&d()});W(()=>{e()});const d=()=>{const{level:o=1,parent_id:s=0}=v.query;t.loading=!0,g.get("/categories",{params:{pageNumber:t.currentPage,pageSize:t.pageSize,categoryLevel:o,parentId:s}}).then(u=>{t.tableData=u.list,t.total=u.totalCount,t.currentPage=u.currPage,t.loading=!1,t.level=o,t.parentId=s})},C=o=>{t.currentPage=o,d()},k=o=>{const s=o.categoryLevel+1;if(s==4){m.error("\u6CA1\u6709\u4E0B\u4E00\u7EA7");return}i.push({name:`level${s}`,query:{level:s,parent_id:o.categoryId}})},x=()=>{t.type="add",_.value.open()},n=o=>{t.type="edit",_.value.open(o)},r=o=>{t.multipleSelection=o},p=()=>{if(!t.multipleSelection.length){m.error("\u8BF7\u9009\u62E9\u9879");return}g.delete("/categories",{data:{ids:t.multipleSelection.map(o=>o.categoryId)}}).then(()=>{m.success("\u5220\u9664\u6210\u529F"),d()})},h=o=>{g.delete("/categories",{data:{ids:[o]}}).then(()=>{m.success("\u5220\u9664\u6210\u529F"),d()})};return(o,s)=>{const u=T,c=K,f=G,R=H,B=J,$=Q;return N(),D($,{class:"category-container"},{header:l(()=>[y("div",oe,[a(u,{type:"primary",icon:w(X),onClick:x},{default:l(()=>[b("\u589E\u52A0")]),_:1},8,["icon"]),a(c,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",onConfirm:p},{reference:l(()=>[a(u,{type:"danger",icon:w(Y)},{default:l(()=>[b("\u6279\u91CF\u5220\u9664")]),_:1},8,["icon"])]),_:1})])]),default:l(()=>[a(R,{load:t.loading,ref:"multipleTable",data:t.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:r},{default:l(()=>[a(f,{type:"selection",width:"55"}),a(f,{prop:"categoryName",label:"\u5206\u7C7B\u540D\u79F0"}),a(f,{prop:"categoryRank",label:"\u6392\u5E8F\u503C",width:"120"}),a(f,{prop:"createTime",label:"\u6DFB\u52A0\u65F6\u95F4",width:"200"}),a(f,{label:"\u64CD\u4F5C",width:"220"},{default:l(F=>[y("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:P=>n(F.row.categoryId)},"\u4FEE\u6539",8,ae),y("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:P=>k(F.row)},"\u4E0B\u7EA7\u5206\u7C7B",8,re),a(c,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",onConfirm:P=>h(F.row.categoryId)},{reference:l(()=>[le]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["load","data"]),a(B,{background:"",layout:"prev, pager, next",total:t.total,"page-size":t.pageSize,"current-page":t.currentPage,onCurrentChange:C},null,8,["total","page-size","current-page"]),a(te,{ref_key:"addCate",ref:_,reload:d,type:t.type},null,8,["type"])]),_:1})}}};var ye=E(ne,[["__file","/Users/picopicopico/Programmer/Project/Web_Project/vue3-admin/src/views/Category.vue"]]);export{ye as default};
